{
    "name": "Ticketing",
    "tables": [
        {
            "name": "TicketStates",
            "isEnum": true,
            "enumItems": [
                {
                    "key": "New",
                    "value": 1
                },
                {
                    "key": "WaitingForBusinessResponse",
                    "value": 2
                },
                {
                    "key": "WaitingForUserResponse",
                    "value": 3
                },
                {
                    "key": "UnderInvestigation",
                    "value": 4
                },
                {
                    "key": "Closed",
                    "value": 5
                }
            ]
        },
        {
            "name": "TicketPriorities",
            "isEnum": true,
            "enumItems": [
                {
                    "key": "High",
                    "value": 1
                },
                {
                    "key": "Medium",
                    "value": 2
                },
                {
                    "key": "Low",
                    "value": 3
                }
            ]
        },
        {
            "name": "Tickets",
            "columns": [
                {
                    "name": "UserGuid"
                },
                {
                    "name": "Title"
                },
                {
                    "name": "TicketPriorityId"
                },
                {
                    "name": "Date"
                },
                {
                    "name": "TicketStateId"
                }
            ]
        },
        {
            "name": "Posts",
            "columns": [
                {
                    "name": "TicketId"
                },
                {
                    "name": "Date"
                },
                {
                    "name": "IsSystemPost",
                    "type": "boolean",
                    "isNullable": true
                }
            ]
        },
        {
            "name": "PostHtmls",
            "oneToOneWith": "Posts",
            "columns": [
                {
                    "name": "Html",
                    "type": "longText"
                }
            ]
        },
        {
            "name": "AttachedFiles",
            "columns": [
                {
                    "name": "PostId"
                },
                {
                    "name": "FileGuid"
                },
                {
                    "name": "FileExtension"
                }
            ]
        }
    ],
    "views": [
        {
            "name": "TicketViews",
            "query": [
                "select",
                "    t.Id,",
                "    t.UserGuid,",
                "    u.DisplayName as `User`,",
                "    t.Title,",
                "    t.UtcDate,",
                "    t.TicketPriorityId,",
                "    tp.`Key` as PriorityKey,",
                "    t.TicketStateId,",
                "    ts.`Key` as StateKey,",
                "    (",
                "        select UtcDate",
                "        from Posts",
                "        where TicketId = t.Id",
                "        order by UtcDate asc",
                "        limit 1",
                "    ) as LatestPostDate",
                "from Tickets t",
                "inner join TicketPriorities tp",
                "on t.PriorityId = tp.Id",
                "inner join TicketStates ts",
                "on t.StateId = ts.Id",
                "left join Accounts.UserViews u",
                "on t.UserGuid = u.Guid"
            ]
        }
    ]
}